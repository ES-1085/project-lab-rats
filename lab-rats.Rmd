lab rats

---
title: "The Relationship Between World Happiness Report Scores and WHO Country Suicide Rates - an Analysis"
author: "Lab rats"
output: github_document
---

```{r install-packages }
#install.packages("tidyverse")
library(tidyverse)

#library(janitor)

#install.packages("naniar")
#library (naniar)

#install.packages("visdat")
#library (visdat)

# install.packages ("leaflet")
# library(leaflet) ## For leaflet interactive maps
# 
# install.packages("sf")
# library(sf) ## For spatial data
# 
# install.packages("RColorBrewer")
# library(RColorBrewer) ## For colour palettes
# 
# install.packages("htmltools")
# library(htmltools) ## For html
# 
# install.packages("leafsync")
# library(leafsync) ## For placing plots side by side
# 
# install.packages("kableExtra")
# library(kableExtra) ## Table output
# 
# install.packages("stringr")
# library(stringr) ## String manipulation
# 
# #install.packages ("rgeoboundaries")
# #library(rgeoboundaries) 

install.packages("gganimate")
library(gganimate)
```

## Summary

Write-up of your project and findings go here. 
Think of this as the text of your presentation. 
The length should be roughly 5 minutes when read out loud.
Although pacing varies, a 5-minute speech is roughly 750 words. 
To use the word count addin, select the text you want to count the words of (probably this is the 
Summary section of this document, go to Addins, and select the `Word count` addin).
This addin counts words using two different algorithms, but the results should be similar and as long as you're in the ballpark of 750 words, you're good! 
The addin will ignore code chunks and only count the words in prose.

You can also load your data here and present any analysis results / plots, but I strongly urge you to keep that to a minimum (maybe only the most important graphic, if you have one you can choose). 
And make sure to hide your code with  `echo = FALSE` unless the point you are trying to make is about the code itself.
Your results with proper output and graphics go in your presentation, this space is for a brief summary of your project.

```{r load-data, echo = FALSE}
# whr_2015 <- read_csv("data/whr_2015.csv")
# whr_2016 <- read_csv("data/whr_2016.csv")
# whr_2017 <- read_csv("data/whr_2017.csv")
# whr_2018 <- read_csv("data/whr_2018.csv")
# whr_2019 <- read_csv("data/whr_2019.csv")
# suicide <- read_csv("data/suicide_2000_2019_v1.csv")


```

### Wrangling and Tidying data 

```{r tidy-data-2015}
# whr_2015 <- whr_2015 %>%
#   mutate(Year = 2015) %>%
#   subset(select = -c(`Standard Error`,`Dystopia Residual`)) %>%
#    rename("Social Support" = "Family") %>%
#    rename("Perceptions of corruption" = "Trust (Government Corruption)") %>%
#   rename("Social support" = "Social Support") %>%
#     rename("GDP per capita" = "Economy (GDP per Capita)",
#           "Overall rank" = "Happiness Rank",
#           "Life expectancy" = "Health (Life Expectancy)") %>%
#    rename("Happiness score" = "Happiness Score") %>%
#  subset(select = -c(`Region`)) %>%
#   clean_names()
```

```{r reordering-cols-2015}

# whr_2015 <- whr_2015 %>% 
#   select(c (overall_rank, country,happiness_score, gdp_per_capita,social_support, life_expectancy, freedom, generosity, perceptions_of_corruption, year))
```

```{r tidy-data-2016}
# whr_2016 <- whr_2016 %>%
# mutate(Year = 2016) %>%
#  subset(select = -c(`Lower Confidence Interval`, `Upper Confidence Interval`, `Dystopia Residual`)) %>%
#  rename("Social support"= "Family") %>%
#  rename("Perceptions of corruption" = "Trust (Government Corruption)") %>%
#  rename("Overall rank" = "Happiness Rank") %>%
#  rename("Happiness score" = "Happiness Score") %>%
#  rename("GDP per capita" = "Economy (GDP per Capita)") %>%
#  rename("Life expectancy" = "Health (Life Expectancy)") %>%
#  subset(select = -c(`Region`)) %>%
# clean_names()
```

```{r reordering-cols-2016}
# whr_2016 <- whr_2016 %>% 
#   select(c (overall_rank, country,happiness_score, gdp_per_capita,social_support, life_expectancy, freedom, generosity, perceptions_of_corruption, year))
```

```{r tidy-data-2017}
# whr_2017 <- whr_2017 %>%
#    mutate(Year = 2017) %>%
#     subset(select = -c(`Whisker.high`,`Whisker.low`,`Dystopia.Residual`)) %>%
#        rename("Social Support"= "Family") %>%
#             rename("Overall rank" = "Happiness.Rank") %>%
#               rename("Happiness score" = "Happiness.Score") %>%
#               rename("GDP per capita" = "Economy..GDP.per.Capita.") %>%
#               rename("Life expectancy" = "Health..Life.Expectancy.") %>%
#               rename("Perceptions of corruption" = "Trust..Government.Corruption.") %>%
#   clean_names()

```

```{r reordering-cols-2017}
# whr_2017 <- whr_2017 %>% 
#   select(c (overall_rank, country,happiness_score, gdp_per_capita,social_support, life_expectancy, freedom, generosity, perceptions_of_corruption, year))
```

```{r tidy-data-2018}
# whr_2018 <- whr_2018 %>% 
#   mutate (Year = 2018) %>%
#    rename("Freedom" = "Freedom to make life choices")%>%
#   rename("Life expectancy" = "Healthy life expectancy",
#          "Country" = "Country or region",
#          "Happiness score" = "Score") %>%
#   clean_names()
```

```{r reordering-cols-2018}
# whr_2018 <- whr_2018 %>% 
#   select(c (overall_rank, country,happiness_score, gdp_per_capita,social_support, life_expectancy, freedom, generosity, perceptions_of_corruption, year))
```

```{r tidy-data-2019}

# whr_2019 <- whr_2019 %>%
#    mutate (Year = 2019) %>%
#   rename("Freedom" = "Freedom to make life choices") %>%
#    rename("Country" = "Country or region",
#           "Life expectancy" = "Healthy life expectancy",
#           "Happiness score" = "Score") %>%
#   #rename("Freedom" = "freedom_to_make_life_choices") %>%
#    #rename("Country" = "Country or region",
#           #"Life expectancy" = "Healthy life expectancy",
#           #"Happiness score" = "Score") %>%
#   clean_names()
```

```{r reordering-cols-2019}
# whr_2019 <- whr_2019 %>% 
#   select(c (overall_rank, country,happiness_score, gdp_per_capita,social_support, life_expectancy, freedom, generosity, perceptions_of_corruption, year))
```

```{r remove-col-2019}
 #whr_2019 <- subset(whr_2019, select = -c(year_2))
```

```{r expand-whr-dataset}
# whr_complete <- whr %>% 
#   expand(country,year)
# 
# whr_complete %>% dplyr::anti_join(whr)
# 
# whr <- whr %>% dplyr::right_join(whr_complete)

```


```{r create-whr}
# whr <- rbind(whr_2015, whr_2016, whr_2017, whr_2018, whr_2019) %>%
#   arrange(country)

# cut Somaliland, northern cyprus 
```


```{r country-names-whr}
whr <- whr %>%
  mutate(country = case_when(country == "United States" ~ "USA",
                       country == "United Kingdom" ~ "UK",
                       country == "United Arab Emirates" ~ "UAE",
                       country == "Palestinian Territories" ~ "Palestine",
                       country == "Congo (Kinshasa)" ~ "DRC",
                       country == "Congo (Brazzaville)" ~ "Congo",
                       country == "Central African Republic" ~ "CAR",
     country == "Hong Kong S.A.R., China" ~ "Hong Kong", TRUE ~ country))

whr_2 <- subset(whr, !(country %in% c("North Cyprus", "Northern Cyprus", "Somaliland")))
```


```{r read-new-datasets}

whr <- read_csv("data/whr.csv")

whr_2 <- read_csv ("data/whr_2.csv")

write_csv( suicide, "suicide.csv")
# suicide <- read_csv ("data/suicide.csv")

suicide_2 <- read_csv("data/suicide_2.csv")
```


```{r suicide-tidy-data}
suicide <- suicide %>%
  clean_names() %>%
select(-c("who_region_code", "who_region", "country_code", "is_latest_year", "crude_suicide_rates_per_100_000_population_low_estimation", "crude_suicide_rates_per_100_000_population_high_estimation", "crude_suicide_rates_per_100_000_population_string")) %>%
rename("suicide_rates" = "crude_suicide_rates_per_100_000_population_numeric") %>%
filter(year %in% c("2015", "2016", "2017", "2018", "2019"))
```

```{r country-names-suicide}

suicide <- suicide %>%
mutate(country = case_when(country == "Syrian Arab Republic" ~ "Syria",
                           country == "United States of America" ~ "USA",
                           country == "United Republic of Tanzania" ~ "Tanzania",
                           country =="Russian Federation" ~ "Russia",
                           country == "The former Yugoslav Republic of Macedonia" ~ "North Macedonia",
                           country == "Lao People's Democratic Republic" ~ "Laos",
                           country == "Cabo Verde" ~ "Cape Verde",
                           country == "Brunei Darussalam" ~ "Brunei",
                           country == "Republic of Korea" ~ "South Korea",
                           country == "Democratic People's Republic of Korea" ~ "North Korea",
                           country == "Democratic Republic of the Congo" ~ "DRC",
                           country == "Iran (Islamic Republic of)" ~ "Iran",
                           country == "Republic of Moldova" ~ "Moldova",
                           country == "Venezuela (Bolivarian Republic of)" ~ "Venezuela",
                           country == "United Arab Emirates" ~ "UAE",
                           country == "United Kingdom of Great Britain and Northern Ireland" ~ "UK",
                           country == "Micronesia (Federated States of)" ~ "Micronesia",
                           country == "Bolivia (Plurinational State of)" ~ "Bolivia", TRUE ~ country))
```

```{r expand-suicide-dataset}

suicide_complete <- suicide %>% 
  expand (country, year, sex, age_group)

suicide_complete %>% dplyr::anti_join(suicide)

suicide_2 <- suicide %>% dplyr::right_join(suicide_complete)

```


## Visualizations

```{r whr-gdp-happiness, fig.alt= "This faceted scatter plot represents the correlation between GDP per capita and Happiness score (years 2015-2019), which appears to have a positive correlation. The data shows us that higher GDP per capita usually correlates to higher happiness scores." }

gdp_per_capita_1 <- ggplot(whr_2, aes(x = gdp_per_capita, y = happiness_score)) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = "lm", aes(group = year)) +
  labs(x = "GDP per capita", y = "Happiness score") +
  labs(title = 'Year: {frame_time}') +
  transition_time(time = year) +
  theme_minimal() +
  theme(
    axis.text = element_text(size = 14),
    axis.title = element_text(size = 17),
    plot.title = element_text(size = 20, face = "bold", hjust = 0.5),
    plot.background = element_rect(fill = "white")
  ) +
  ggtitle("The correlation between GDP per capita\nand happiness score (WHR {frame_time})")

gdp_per_capita_2 <- animate(gdp_per_capita_1, nframes = 5, fps = 1.5, renderer = gifski_renderer())
anim_save(filename = "gdp_per_capita_happiness.gif")
```

```{r whr-social-support-happiness, fig.alt= ""This faceted scatter plot represents the correlation between access to social supports and Happiness score for years 2015-2019.These two variables appear to have a positive correlation. The data shows us that more social supports usually correlate to higher happiness scores."}

social_support_1 <- ggplot(whr_2, aes(x = social_support, y = happiness_score)) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = "lm", aes(group = year)) +
  labs(x = "Social support", y = "Happiness score") +
  labs(title = 'Year: {frame_time}') +
  transition_time(time = year) +
  theme_minimal() +
  theme(
    axis.text = element_text(size = 14),
    axis.title = element_text(size = 17),
    plot.title = element_text(size = 20, face = "bold", hjust = 0.5),
    plot.background = element_rect(fill = "white")
  ) +
  ggtitle("The correlation between social support\nand happiness score (WHR {frame_time})")

social_support_2 <- animate(social_support_1, nframes = 5, fps = 1.5, renderer = gifski_renderer())
anim_save(filename = "social_support_happiness.gif")
```

```{r whr-life-expectancy-happiness, fig.alt= "This faceted scatter plot represents the correlation between life expectancy and Happiness score (years 2015-2019), which appears to have a positive correlation. The data shows us that longer life expectancies usually correlates to higher happiness scores."}

life_expectancy_1 <- ggplot(whr_2, aes(x = life_expectancy, y = happiness_score)) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = "lm", aes(group = year)) +
  labs(x = "Life expectancy", y = "Happiness score") +
  labs(title = 'Year: {frame_time}') +
  transition_time(time = year) +
  theme_minimal() +
  theme(
    axis.text = element_text(size = 14),
    axis.title = element_text(size = 17),
    plot.title = element_text(size = 20, face = "bold", hjust = 0.5),
    plot.background = element_rect(fill = "white")
  ) +
  ggtitle("The correlation between life expectancy\nand happiness score (WHR {frame_time})")

life_expectancy_2 <- animate(life_expectancy_1, nframes = 5, fps = 1.5, renderer = gifski_renderer())
anim_save(filename = "life_expectancy_happiness.gif")
```

```{r whr-freedom-happiness, fig.alt= "This faceted scatter plot represents the correlation between freedom ratings and Happiness score, which appears to have a positive line of average. The data shows us that there's still, although not as distinct, positive correlation between freedom and happiness scores."}

freedom_1 <- ggplot(whr_2, aes(x = freedom, y = happiness_score)) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = "lm", aes(group = year)) +
  labs(x = "Freedom", y = "Happiness score") +
  labs(title = 'Year: {frame_time}') +
  transition_time(time = year) +
  theme_minimal() +
  theme(
    axis.text = element_text(size = 14),
    axis.title = element_text(size = 17),
    plot.title = element_text(size = 20, face = "bold", hjust = 0.5),
    plot.background = element_rect(fill = "white")
  ) +
  ggtitle("The correlation between freedom\nand happiness score (WHR {frame_time})")

freedom_2 <- animate(freedom_1, nframes = 5, fps = 1.5, renderer = gifski_renderer())
anim_save(filename = "freedom_happiness.gif")
```

```{r whr-generosity-happiness fig.alt= "This faceted scatter plot represents the correlation between generosity percieved by each country and Happiness score, which appears to not have a strong correlation. The data shows us that happiness scores vary between being very high and low, despite despite percieved generosity for each country."}

generosity_1 <- ggplot(whr_2, aes(x = generosity, y = happiness_score)) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = "lm", aes(group = year)) +
  labs(x = "Generosity", y = "Happiness score") +
  labs(title = 'Year: {frame_time}') +
  transition_time(time = year) +
  theme_minimal() +
  theme(
    axis.text = element_text(size = 14),
    axis.title = element_text(size = 17),
    plot.title = element_text(size = 20, face = "bold", hjust = 0.5),
    plot.background = element_rect(fill = "white")
  ) +
  ggtitle("The correlation between generosity\nand happiness score (WHR {frame_time})")

generosity_2 <- animate(generosity_1, nframes = 5, fps = 1.5, renderer = gifski_renderer())
anim_save(filename = "generosity_happiness.gif")
```

```{r whr-corruption-happiness}

perceptions_of_corruption_1 <- ggplot(whr_2, aes(x = as.numeric(perceptions_of_corruption), y = happiness_score)) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = "lm", aes(group = year)) +
  labs(x = "Perceptions of corruption", y = "Happiness score") +
  labs(title = 'Year: {frame_time}') +
  transition_time(time = year) +
  theme_minimal() +
  theme(
    axis.text = element_text(size = 14),
    axis.title = element_text(size = 17),
    plot.title = element_text(size = 20, face = "bold", hjust = 0.5),
    plot.background = element_rect(fill = "white")
  ) +
  ggtitle("The correlation between perceptions of\nand corruption happiness score (WHR {frame_time})")

perceptions_of_corruption_2 <- animate(perceptions_of_corruption_1, nframes = 5, fps = 1.5, renderer = gifski_renderer())
anim_save(filename = "perceptions_of_corruption_happiness.gif")
```

```{r missing-values fig.alt= "This Bar Graph represents all possible missing data from our whr dataset. The X axis lists the variables that the data is organized under, and the Y axis represents number of observations. The red represents all character data, while the blue represents all numerical variables, The grey represents what variables are missing data inputs, which is 6.4% of all the data."}


# visdat::vis_miss(suicide_2)

visdat::vis_dat(whr)


visdat::vis_miss(whr)

```


```{r suicide-vs-GDP-scatter, fig.alt="This faceted scatterplot looks at the correlation of three variables: suicide rates on the Y axis in regards to GDP on the X axis, warning=FALSE, and then WHR happiness scores that are being represented in a color gradient. Low happiness scores are expressed with deep purple and blue (3-4), mid-range scores are expressed with lighter blue and green (5-6), and high happiness scores are expressed with bright green and yellow (>=7). Though the correlation between suicide rates and GDP per capita don't appear to be strong}

 suicide_2 %>%
  filter(sex == "Both sexes",
         age_group == "All Ages") %>%
  full_join(whr_2, by = join_by(country, year)) %>%
ggplot() +
  geom_point(aes(x = gdp_per_capita, 
                 y = suicide_rates)) +
  geom_miss_point(aes(x = gdp_per_capita, 
                      y = suicide_rates, 
                      color = happiness_score), 
                  alpha = 0.5) +
  geom_smooth(aes(x = gdp_per_capita, 
                  y = suicide_rates), 
              method = "lm") +
  labs(x = "GDP per capita", 
       y = "Suicide Rates", 
       color = "WHR Happiness Score",
       title = "Correlation between GDP per capita and Suicide Rates",
       subtitle = " Between 2015-2019") +
  facet_wrap(~ year, ncol = 2) +
  scale_color_viridis_c() +
  jpeg(filename = "suicide-vs-GDP-scatter.jpeg" ) +
  theme_ipsum ()

```

```{r attempt-violinplot}
suicide_2 %>%
  filter(sex %in% c ("Male","Female"),
         age_group == "All Ages",
         country %in% c ("Lesotho","South Sudan",
                         "New Zealand","Portugal",
                         "China", "Brazil",
                         "Costa Rica", "Zimbabwe",
                         "Israel", "Mexico")) %>%
  mutate(year = factor(year, levels=c(2015, 2016, 2017, 2018, 2019)))%>%
   ggplot(aes(fill=sex, y= suicide_rates, x= year)) +
  geom_violin(position="dodge", alpha=0.5, outlier.colour="transparent") +
    scale_fill_viridis_d(name= "Sex") +
    # theme_ipsum()  +
    xlab("Year") +
    ylab("Suicide rates") +
  labs(title = "Collective Suicide Rates of Randomly Selected Countries",
       subtitle = "By Sex")
    ylim(0,40)
  

```


```{r finding-special-cases}
suicide_2 %>%
  filter(sex == "Both sexes", age_group == "All Ages") %>%
  full_join(whr_2, by = join_by(country, year))  %>%
  filter(gdp_per_capita <= 0.5, suicide_rates <= 4)
```

```{r joined-datasets}

sui_joined_1 <- suicide_2 %>%
  filter(sex == "Both sexes",
         age_group == "All Ages") %>%
  full_join(whr_2, by = join_by(country, year)) 
  
sui_joined_1$overall_rank <- as.numeric(as.character(sui_joined_1$overall_rank))
```


```{r map-viz}

download.file("http://thematicmapping.org/downloads/TM_WORLD_BORDERS_SIMPL-0.3.zip" , destfile="data/world_shape_file.zip")

unzip("data/world_shape_file.zip")

 library(rgdal)
joined_1 <- readOGR(
  dsn= paste0(getwd(),"/TM_WORLD_BORDERS_SIMPL-0.3.shp") ,
  layer="TM_WORLD_BORDERS_SIMPL-0.3",
  verbose=FALSE)


joined_1 <- st_as_sf(joined_1)
joined_2 <- full_join(joined_1, sui_joined_1, by = join_by(NAME == country))

# library(dplyr)
# world_spdf@data$POP2005[ which(world_spdf@data$POP2005 == 0)] = NA
# world_spdf@data$POP2005 <- as.numeric(as.character(world_spdf@data$POP2005)) / 1000000 %>% round(2)


```

```{r}

# m <- leaflet(joined_1) %>% 
#   addTiles()  %>% 
#   setView(lat=10, lng=0 , zoom=1)%>%
#    addPolygons( fillColor = ~mypalette(POP2005), 
#                 stroke=TRUE,
#                 )


# joined_1 %>%
#   leaflet() %>%
#   addTiles() %>% 
#   addPolygons(fillColor = -pal (overall_rank))


```

```{r}
joined_2019 <- joined_2 %>%
  filter(year == 2019)

mypalette <- colorNumeric(palette="OrRd", domain=joined_2019$overall_rank, na.color="transparent")



leaflet(data = joined_2019) %>%
  addProviderTiles(providers$Esri.WorldImagery) %>%
  setView(lng = -80, 
          lat = 34.5, 
          zoom = 5) %>%
  addPolygons(fillColor = ~mypalette(overall_rank))
  #addPolygons()
```

```{r portugal-bar-plot}
suicide_2 %>%
   filter(sex %in% c("Female", "Male") &
         age_group == "All Ages") %>%
  full_join(whr_2, by = join_by(country, year)) %>%
  filter(country == "Portugal") %>%
  group_by(year) %>%
  ggplot(aes(x = year, y= suicide_rates , fill = sex)) +
  geom_bar(position="dodge", stat="identity", alpha = 0.7) +
  scale_fill_viridis_d() +
   labs(x = "Year",
       y = "Suicide Rates",
       title = "Suicide Rates of Portugal By Year",
       subtitle = "Organized by Sex")
```

```{r china-bar-plot}
suicide_2 %>%
   filter(sex %in% c("Female", "Male") &
         age_group == "All Ages") %>%
  full_join(whr_2, by = join_by(country, year)) %>%
  filter(country == "China") %>%
  group_by(year) %>%
  ggplot(aes(x = year, y= suicide_rates , fill = sex)) +
  geom_bar(position="dodge", stat="identity", alpha = 0.8) +
  scale_fill_viridis_d() +
   labs(x = "Year",
       y = "Suicide Rates",
       title = "Suicide Rates of China By Year",
       subtitle = "Organized by Sex")
       
```

```{r brazil-bar-plot}
suicide_2 %>%
   filter(sex %in% c("Female", "Male") &
         age_group == "All Ages") %>%
  full_join(whr_2, by = join_by(country, year)) %>%
  filter(country == "Brazil") %>%
  group_by(year) %>%
  ggplot(aes(x = year, y= suicide_rates , fill = sex)) +
  geom_bar(position="dodge", stat="identity", alpha = 0.7) +
  scale_fill_viridis_d() +
   labs(x = "Year",
       y = "Suicide Rates",
       title = "Suicide Rates of Brazil By Year",
       subtitle = "Organized by Sex")
```

```{r costa-rica-bar-plot}
suicide_2 %>%
   filter(sex %in% c("Female", "Male") &
         age_group == "All Ages") %>%
  full_join(whr_2, by = join_by(country, year)) %>%
  filter(country == "Costa Rica") %>%
  group_by(year) %>%
  ggplot(aes(x = year, y= suicide_rates , fill = sex)) +
  geom_bar(position="dodge", stat="identity", alpha = 0.8) +
  scale_fill_viridis_d() +
   labs(x = "Year",
       y = "Suicide Rates",
       title = "Suicide Rates of Costa Rica By Year",
       subtitle = "Organized by Sex")
```

```{r zimbabwe-bar-plot}
suicide_2 %>%
   filter(sex %in% c("Female", "Male") &
         age_group == "All Ages") %>%
  full_join(whr_2, by = join_by(country, year)) %>%
  filter(country == "Zimbabwe") %>%
  group_by(year) %>%
  ggplot(aes(x = year, y= suicide_rates , fill = sex, alpha = 0.8)) +
  geom_bar(position="dodge", stat="identity") +
  scale_fill_viridis_d() +
   labs(x = "Year",
       y = "Suicide Rates",
       title = "Suicide Rates of Zimbabwe By Year",
       subtitle = "Organized by Sex")
```


```{r israel-bar-plot}
suicide_2 %>%
   filter(sex %in% c("Female", "Male") &
         age_group == "All Ages") %>%
  full_join(whr_2, by = join_by(country, year)) %>%
  filter(country == "Israel") %>%
  group_by(year) %>%
  ggplot(aes(x = year, y= suicide_rates , fill = sex)) +
  geom_bar(position="dodge", stat="identity", alpha = 0.8) +
  scale_fill_viridis_d() +
   labs(x = "Year",
       y = "Suicide Rates",
       title = "Suicide Rates of Israel By Year",
       subtitle = "Organized by Sex")
```


```{r mexico-bar-plot}
suicide_2 %>%
   filter(sex %in% c("Female", "Male") &
         age_group == "All Ages") %>%
  full_join(whr_2, by = join_by(country, year)) %>%
  filter(country == "Mexico") %>%
  group_by(year) %>%
  ggplot(aes(x = year, y= suicide_rates , fill = sex)) +
  geom_bar(position="dodge", stat="identity", alpha = 0.8) +
  scale_fill_viridis_d() +
   labs(x = "Year",
       y = "Suicide Rates",
       title = "Suicide Rates of Mexico By Year",
       subtitle = "Organized by Sex")
```


```{r new-zealand-bar-plot}
suicide_2 %>%
   filter(sex %in% c("Female", "Male") &
         age_group == "All Ages") %>%
  full_join(whr_2, by = join_by(country, year)) %>%
  filter(country == "New Zealand") %>%
  group_by(year) %>%
  ggplot(aes(x = year, y= suicide_rates , fill = sex)) +
  geom_bar(position="dodge", stat="identity", alpha = 0.8) +
  scale_fill_viridis_d() +
   labs(x = "Year",
       y = "Suicide Rates",
       title = "Suicide Rates of New Zealand By Year",
       subtitle = "Organized by Sex")
```

```{r south-sudan-bar-plot}
suicide_2 %>%
   filter(sex %in% c("Female", "Male") &
         age_group == "All Ages") %>%
  full_join(whr_2, by = join_by(country, year)) %>%
  filter(country == "South Sudan") %>%
  group_by(year) %>%
  ggplot(aes(x = year, y= suicide_rates , fill = sex)) +
  geom_bar(position="dodge", stat="identity", alpha = 0.7) +
  scale_fill_viridis_d() +
   labs(x = "Year",
       y = "Suicide Rates",
       title = "Suicide Rates of South Sudan By Year",
       subtitle = "Organized by Sex")
```
```


```{r faceted-bar-plot}
suicide_2 %>%
   filter(sex %in% c("Female", "Male") &
         age_group == "All Ages") %>%
  full_join(whr_2, by = join_by(country, year)) %>%
  filter(country %in% c("New Zealand", "Zimbabwe", "Portugal", "Brazil", "China", "Mexico", "Israel")) %>%
  group_by(year) %>%
  ggplot(aes(x = as.numeric(year), y= suicide_rates , fill = sex)) +
  geom_bar(position="dodge", stat="identity",) +
  scale_fill_viridis_d() +
   facet_wrap(~ country, ncol = 2) +
   labs(x = "Year",
       y = "Suicide Rates",
       title = "Suicide Rates of Randomly Selected Countries",
       subtitle = "Organized by Sex")
```




```{r lesotho-outlier-barplot}
suicide_2 %>%
   filter(sex %in% c("Female", "Male") &
         age_group == "All Ages") %>%
  full_join(whr_2, by = join_by(country, year)) %>%
  filter(country == "Lesotho") %>%
  group_by(year) %>%
  ggplot(aes(x = year, y= suicide_rates , fill = sex)) +
  geom_bar(position="dodge", stat="identity", alpha = 0.8) +
  scale_fill_viridis_d() +
   labs(x = "Year",
       y = "Suicide Rates",    
       title = "Suicide Rates of Lesotho By Year", 
       subtitle = "Organized by Sex")
```

```


## Presentation



```


## Data 

Include a citation for your data here. 
See http://libraryguides.vu.edu.au/c.php?g=386501&p=4347840 for guidance on proper citation for datasets. 
If you got your data off the web, make sure to note the retrieval date.

## References

List any references here. You should, at a minimum, list your data source.
